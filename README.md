# CFD-HW2

写于2025.3.15
本程序为北京大学工学院2025年春季学期课程“计算流体力学”第二次作业。

1. 该程序由Python语言写成，整体上分为三部分：测试函数与各种参量、差分格式构造及误差计算、绘图。
2. 对于一阶导，使用了二阶中心差分与四阶中心差分格式。
3. 对于二阶导，使用了一阶向前差分与二阶中心差分格式。
4. 对于每一种格式，计算了总误差、截断误差与舍入误差。
5. 单精度与双精度的作用待补充（第一版代码用的是双精度）。

测试函数：u = e^(-x)*sin(k*x), k为波数

解题思路：
差分格式的构造源自讲义。
P.s.: 因为是通宵写的，很多循环写得非常臃肿和丑陋（）


以下讨论截断误差与舍入误差的规律：
1. 一阶导二阶中心差分格式：对于截断误差，随dx^2减小，误差与波数k的立方相关；对于舍入误差，随1/dx增大，当dx<10e-5时主导误差；对于绝对误差，最小误差出现在dx=10e-5处；
2. 一阶导四阶中心差分格式：对于截断误差，随dx^4减小，误差与波数k的5次方相关；对于舍入误差，随1/dx增大，但比二阶方法更敏感；对于绝对误差，最小误差出现在dx=10e-4处；
3. 二阶导一阶向前差分格式：对于截断误差；随dx线性减少，与波数k的立方相关；对于舍入误差，随1/dx^2急剧增大，当dx<10e-4时主导误差；对于绝对误差，比中心差分大1-3个数量级，在dx=10e-3处勉强可用；
4. 二阶导二阶中心差分格式：对于截断误差，当k=1时，理论误差消失，实际误差由更高阶项主导；k=2时，TE_trunc正比于2dx^2；对于舍入误差，随1/dx^2急剧增大，当dx<10e-4时主导误差；对于绝对误差，k=1时误差很小；k=2时最小误差出现在dx=10e-5。
